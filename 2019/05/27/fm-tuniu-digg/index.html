<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>fm_tuniu_digg | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="背景Fm是工业界比较常用的机器学习算法，在点击预估场景下都能有很好的效果。 FMFM(Factorization Machine)通过向量交叉学习的方式来挖掘特征之间的相关性,实现组合特征，能够很好的挖掘数据特征间的相关性，可以做分类，排序，回归。适应于高度稀疏的特征矩阵，目标函数及优化学习时候都可以在线性时间完成从而也适合在线学习。适用于ctr点击预估，推荐。">
<meta name="keywords" content="FM">
<meta property="og:type" content="article">
<meta property="og:title" content="fm_tuniu_digg">
<meta property="og:url" content="http://yoursite.com/2019/05/27/fm-tuniu-digg/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="背景Fm是工业界比较常用的机器学习算法，在点击预估场景下都能有很好的效果。 FMFM(Factorization Machine)通过向量交叉学习的方式来挖掘特征之间的相关性,实现组合特征，能够很好的挖掘数据特征间的相关性，可以做分类，排序，回归。适应于高度稀疏的特征矩阵，目标函数及优化学习时候都可以在线性时间完成从而也适合在线学习。适用于ctr点击预估，推荐。">
<meta property="og:image" content="http://yoursite.com/Users/liwenzhe/Library/Application%20Support/typora-user-images/image-20190325111435777.png">
<meta property="og:image" content="http://yoursite.com/Users/liwenzhe/Downloads/WX20190325-104644@2x.png">
<meta property="og:image" content="http://yoursite.com/Users/liwenzhe/Downloads/WX20190325-104551@2x.png">
<meta property="og:updated_time" content="2019-05-26T23:17:48.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="fm_tuniu_digg">
<meta name="twitter:description" content="背景Fm是工业界比较常用的机器学习算法，在点击预估场景下都能有很好的效果。 FMFM(Factorization Machine)通过向量交叉学习的方式来挖掘特征之间的相关性,实现组合特征，能够很好的挖掘数据特征间的相关性，可以做分类，排序，回归。适应于高度稀疏的特征矩阵，目标函数及优化学习时候都可以在线性时间完成从而也适合在线学习。适用于ctr点击预估，推荐。">
<meta name="twitter:image" content="http://yoursite.com/Users/liwenzhe/Library/Application%20Support/typora-user-images/image-20190325111435777.png">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head1.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">逆拂</a></h1>
        </hgroup>

        
        <p class="header-subtitle">生命是长期而持续的积累</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/works">作品展示</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://github.com/Neef6" title="github">github</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/FM/" style="font-size: 10px;">FM</a> <a href="/tags/FM衍生算法/" style="font-size: 10px;">FM衍生算法</a> <a href="/tags/ML/" style="font-size: 10px;">ML</a> <a href="/tags/big-data-hdfs/" style="font-size: 10px;">big_data hdfs</a> <a href="/tags/lvs-负载均衡/" style="font-size: 10px;">lvs 负载均衡</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://luuman.github.io/">name</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱运动、爱交友、爱旅行、喜欢接触新鲜事物、迎接新的挑战，更爱游离于错综复杂的编码与逻辑中</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">逆拂</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head1.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">逆拂</a></h1>
            </hgroup>
            
            <p class="header-subtitle">生命是长期而持续的积累</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/works">作品展示</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/Neef6" title="github">github</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-fm-tuniu-digg" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/05/27/fm-tuniu-digg/" class="article-date">
      <time datetime="2019-05-26T23:14:12.000Z" itemprop="datePublished">2019-05-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      fm_tuniu_digg
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FM/">FM</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>Fm是工业界比较常用的机器学习算法，在点击预估场景下都能有很好的效果。</p>
<h2 id="FM"><a href="#FM" class="headerlink" title="FM"></a>FM</h2><p>FM(Factorization Machine)通过向量交叉学习的方式来挖掘特征之间的相关性,实现组合特征，能够很好的挖掘数据特征间的相关性，可以做分类，排序，回归。适应于高度稀疏的特征矩阵，目标函数及优化学习时候都可以在线性时间完成从而也适合在线学习。适用于ctr点击预估，推荐。</p>
<a id="more"></a> 
<h2 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h2><ol>
<li>线性复杂度</li>
<li>特征组合</li>
<li>可以处理高度稀疏数据</li>
</ol>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>二阶FM公式：</p>
<p><img src="/Users/liwenzhe/Library/Application%20Support/typora-user-images/image-20190325111435777.png" alt="image-20190325111435777"></p>
<p>时间复杂度O($k$$n^2$)，</p>
<p>参数个数为1+n+$\frac{n*k}{2}$</p>
<p>公式可以进一步化简，时间复杂度降低到O($k*$n)，从而适用于工业生产环境及大规模数据</p>
<p><img src="/Users/liwenzhe/Downloads/WX20190325-104644@2x.png" alt="WX20190325-104644@2x"></p>
<h3 id="特征交叉"><a href="#特征交叉" class="headerlink" title="特征交叉"></a>特征交叉</h3><table>
<thead>
<tr>
<th></th>
<th>年龄</th>
<th>北京</th>
<th>上海</th>
<th>广州</th>
<th>男</th>
<th>女</th>
</tr>
</thead>
<tbody>
<tr>
<td>用户1</td>
<td>25</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>用户2</td>
<td>17</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>普通的线性模型，我们都是将各个特征独立考虑的，并没有考虑到特征与特征之间的相互关系。但实际上，特征之间可能具有一定的关联。</p>
<p>图表中，“北京的男性用户”、“上海的女性用户”这种组合特征可能是有意义并且有用的。</p>
<h3 id="高度稀疏数据"><a href="#高度稀疏数据" class="headerlink" title="高度稀疏数据"></a>高度稀疏数据</h3><p>FM在高度稀疏的情况下特征之间的交叉仍然能够估计，而且可以泛化到未被观察的交叉</p>
<p>FM构造特征向量和标签的示例：</p>
<p><img src="/Users/liwenzhe/Downloads/WX20190325-104551@2x.png" alt="WX20190325-104551@2x"></p>
<p>每行表示目标 $y^i$ 与其对应的特征向量 $x^i$ ，蓝色框表征当前评分用户，橘色框表征当前被评分电影信息，黄色框表征当前评分用户评分过得所有电影信息，绿色框表征投票时间信息，褐红框表征当前用户最近评分过的一部电影。，最右边的区域是评分。</p>
<p>如上面的例子，可以在上面例子基础上增加新的特征。比如性别，年龄，学历，主题，tag，位置，时间。还可以尝试一些trick。</p>
<p>同时大量类别特征引入，会使得矩阵更加的稀疏。然而FM仍然可以估计特征交叉，同时通过调整k还可以调整模型的泛化能力。</p>
<p>原因如下(原文paper)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Assume we want to estimate the interaction between Alice (A) and Star Trek (ST) for predicting the target y (here the rating). Obviously, there is no case x in the training data where both variables xA and xST are non-zero and thus a direct estimate would lead to no interaction (wA,ST = 0). But with the factorized interaction parameters ⟨vA,vST⟩ we can estimate the interaction even in this case. First of all, Bob and Charlie will have similar factor vectors vB and vC because both have similar interactions with Star Wars (vSW) for predicting ratings – i.e. ⟨vB,vSW⟩ and ⟨vC,vSW⟩ have to be similar. Alice (vA) will have a different factor vector from Charlie (vC) because she has different interactions with the factors of Titanic and Star Wars for predicting ratings. Next, the factor vectors of Star Trek are likely to be similar to the one of Star Wars because Bob has similar interactions for both movies for predicting y. In total, this means that the dot product (i.e. the interaction) of the factor vectors of Alice and Star Trek will be similar to the one of Alice and Star Wars</span><br></pre></td></tr></table></figure>
<h3 id="优化算法"><a href="#优化算法" class="headerlink" title="优化算法"></a>优化算法</h3><p>选用了FTRL。FTRL算法的设计思想是<strong>每次找到让之前所有目标函数（损失函数加正则项）之和最小的参数</strong>。该算法在处理诸如逻辑回归之类的带非光滑正则化项（如L1正则项）的凸优化问题上表现出色</p>
<p>FTRL是FOBOS和RDA算法的综合</p>
<ol>
<li>FOBOS。更新w时候对每个维度进行判断，当一个样本的梯度不足以令对应维度上的权重反正较大变化，认为不重要，截断置零。阀值随t减小。</li>
<li>RDA。在sgd基础上。在w更新策略包含一个梯度对w的积分平均值，正则项和辅助的强凸函数。截断阀值不变</li>
</ol>
<p>FTRL优点：</p>
<ol>
<li>每次找到让之前所有目标函数（损失函数加正则项）之和最小的参数</li>
<li>算法在提高模型解的稀疏性方面比其他(gd,sgd,momentum)等，效果显著</li>
<li>对每一维分开训练更新，每一维度使用的是不同的学习率。优点是考虑了样本本身在不同特征分布上的不均衡性。</li>
</ol>
<h3 id="多阶FM"><a href="#多阶FM" class="headerlink" title="多阶FM"></a>多阶FM</h3><p>​    上文提到的FM是2-way(二阶)FM，FM也有多阶的形式。</p>
<h2 id="FM与其他算法对比"><a href="#FM与其他算法对比" class="headerlink" title="FM与其他算法对比"></a>FM与其他算法对比</h2><h3 id="FM与协同过滤"><a href="#FM与协同过滤" class="headerlink" title="FM与协同过滤"></a>FM与协同过滤</h3><p>协同过滤是FM的一个特例，矩阵分解特征只有用户和商品，而FM可以采用其他特征，学习更多特征组合，更加具有普适性。</p>
<h3 id="FM与决策树"><a href="#FM与决策树" class="headerlink" title="FM与决策树"></a>FM与决策树</h3><p>决策树同样可以做特征组合，而且很方便的对特征做高阶组合。但是这种高阶组合需要在数据集里存在。因为这种高阶的特征模式数据不存在的话，或者数据特别少。那么决策树对一个特征分裂后就不会用另一个特征分裂了。所以在高度稀疏的数据中，决策树很难学习到高阶的特征组合</p>
<h3 id="FM与神经网络"><a href="#FM与神经网络" class="headerlink" title="FM与神经网络"></a>FM与神经网络</h3><p>神经网络可以对embedding后的稀疏离散特征做更复杂的非线性变换</p>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><ol>
<li><p>通过离线模型训练获得模型参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">fm_model = xl.create_fm()</span><br><span class="line">fm_model.setTrain(<span class="string">"./Train.txt"</span>)</span><br><span class="line">fm_model.setValidate(<span class="string">"./Validate.txt"</span>)</span><br><span class="line">fm_model.setValidate(<span class="string">"./Test.txt"</span>)</span><br><span class="line">fm_model.setTXTModel(<span class="string">"model.txt"</span>)</span><br><span class="line">fm_model.fit(param,<span class="string">"model_output.out"</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>online使用spark streaming，对实时数据做预测并输出</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> warehouse_location = <span class="string">""</span></span><br><span class="line"><span class="keyword">val</span> log: <span class="type">Logger</span> = <span class="type">LoggerFactory</span>.getLogger(<span class="keyword">this</span>.getClass)</span><br><span class="line"><span class="keyword">val</span> sparkSession: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder()</span><br><span class="line">     .appName(<span class="string">"FM Onling Perdict"</span>)</span><br><span class="line">     .config(<span class="string">"spark.sql.warehouse.dir"</span>, warehouse_location)</span><br><span class="line">     .config(<span class="string">"spark.serializer"</span>, <span class="string">"org.apache.spark.serializer.KryoSerializer"</span>)</span><br><span class="line">     .config(<span class="string">"spark.streaming.backpressure.enabled"</span>, <span class="string">"true"</span>)</span><br><span class="line">     .config(<span class="string">"spark.streaming.backpressure.initialRate"</span>, <span class="number">20</span>L).getOrCreate()</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> messages = <span class="type">KafkaUtils</span>.createDirectStream[<span class="type">String</span>, <span class="type">String</span>, <span class="type">StringDecoder</span>, <span class="type">StringDecoder</span>](</span><br><span class="line">     ssc, kafkaParameters, topicSet).mapPartitions</span><br><span class="line"><span class="keyword">val</span> fmode: <span class="type">FMModel</span> = <span class="type">FMWithFTRL</span>.load(**,offlinePara, numFeatures)</span><br><span class="line">fmode.predict()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="FM扩展"><a href="#FM扩展" class="headerlink" title="FM扩展"></a>FM扩展</h2><ol>
<li><p>高阶组合的学习。</p>
<p>fm算法多用其低阶模式，考虑高阶特征组合可以使用其延伸的各种算法。比如DeepFm</p>
</li>
<li><p>时序信息的学习</p>
<p>参考paper：Factorizing Personalized Markov Chains for Next-Basket Recommendation</p>
</li>
</ol>
<p>参考：</p>
<p><a href="https://www.cnblogs.com/zhangchaoyang/articles/7897085.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhangchaoyang/articles/7897085.html</a></p>
<p><a href="https://www.jiqizhixin.com/articles/2018-07-16-17" target="_blank" rel="noopener">https://www.jiqizhixin.com/articles/2018-07-16-17</a></p>
<p><a href="https://blog.csdn.net/QFire/article/details/77630816" target="_blank" rel="noopener">https://blog.csdn.net/QFire/article/details/77630816</a></p>

      
      
        <div class="page-reward">
          <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang">赏</a></p>
          <div class="hide_box"></div>
          <div class="shang_box">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">×</a>
            <div class="shang_tit">
              <p>纯属好玩</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="扫码支持" title="扫一扫" />
            </div>
              <div class="pay_explain">扫码打赏，你说多少就多少</div>
            <div class="shang_payselect">
              
                <div class="pay_item checked" data-id="alipay">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/alipay.png" alt="支付宝" /></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/weixin.png" alt="微信" /></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>打开<span id="shang_pay_txt">支付宝</span>扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"支付宝":"微信");
          });
          function dashangToggle(){
            
            $(".hide_box").fadeToggle();
            $(".shang_box").fadeToggle();
          }
        </script>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2019/05/27/fm-tuniu-digg/">fm_tuniu_digg</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 逆拂 的个人博客">逆拂</a></p>
        <p><span>发布时间:</span>2019年05月27日 - 07时14分</p>
        <p><span>最后更新:</span>2019年05月27日 - 07时17分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2019/05/27/fm-tuniu-digg/" title="fm_tuniu_digg">http://yoursite.com/2019/05/27/fm-tuniu-digg/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2019/05/27/fm-tuniu-digg/　　作者: 逆拂" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
  
    <a href="/2018/12/18/fm/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">FM衍生的各类算法</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#背景"><span class="toc-number">1.</span> <span class="toc-text">背景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FM"><span class="toc-number">2.</span> <span class="toc-text">FM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#优点"><span class="toc-number">3.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原理"><span class="toc-number">4.</span> <span class="toc-text">原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#特征交叉"><span class="toc-number">4.1.</span> <span class="toc-text">特征交叉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高度稀疏数据"><span class="toc-number">4.2.</span> <span class="toc-text">高度稀疏数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优化算法"><span class="toc-number">4.3.</span> <span class="toc-text">优化算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多阶FM"><span class="toc-number">4.4.</span> <span class="toc-text">多阶FM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FM与其他算法对比"><span class="toc-number">5.</span> <span class="toc-text">FM与其他算法对比</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FM与协同过滤"><span class="toc-number">5.1.</span> <span class="toc-text">FM与协同过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FM与决策树"><span class="toc-number">5.2.</span> <span class="toc-text">FM与决策树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FM与神经网络"><span class="toc-number">5.3.</span> <span class="toc-text">FM与神经网络</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实践"><span class="toc-number">6.</span> <span class="toc-text">实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FM扩展"><span class="toc-number">7.</span> <span class="toc-text">FM扩展</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <div id="gitments"></div>
<script src="/js/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
      id: window.location.pathname,
      owner: 'luuman',
      repo: 'luuman.github.io',
      oauth: {
        client_id: '',
        client_secret: '',
      },
    })
    gitment.render('gitments')
</script>
    



    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2018/12/18/fm/" title="下一篇: FM衍生的各类算法">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/05/27/fm-tuniu-digg/">fm_tuniu_digg</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/18/fm/">FM衍生的各类算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/12/HA/">HA</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/12/lvs/">lvs</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/05/决策树/">DT</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 逆拂
            </div>
            <div class="footer-right">
            other blog:lolvs.cn
	    </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >本页访问数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>